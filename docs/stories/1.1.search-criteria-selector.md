# Story 1.1: Search Criteria Selector Component

<!-- Powered by BMADâ„¢ Core -->

## Status

Ready for Dev

## Story

**As a** HR administrator,
**I want** select what field to search by (ID, Name, Email, Phone),
**so that** I can perform targeted searches that are more efficient and relevant to my needs.

## Acceptance Criteria

1. Implement a shadcn Select component with search field options: Human Readable ID, First Name, Last Name, Email, Phone Number
2. The selector should be positioned adjacent to the search input field
3. Default selection should be "Human Readable ID" as it's the most precise
4. Component must be fully accessible with proper ARIA labels and keyboard navigation
5. Selected option must be visually indicated to users
6. Component should follow existing design system patterns

## Tasks / Subtasks

- [ ] Task 1: Update Employee Store with Search Field Type (AC: 1, 3)
  - [ ] Add `searchField` property to `EmployeeFilters` interface
  - [ ] Add search field options constant with default value
  - [ ] Update `setFilters` function to handle search field selection
  - [ ] Ensure search field is persisted in filter state

- [ ] Task 2: Create Search Field Selector Component (AC: 1, 3, 4, 5, 6)
  - [ ] Create new component using shadcn Select component
  - [ ] Position selector adjacent to existing search input
  - [ ] Configure default selection to "Human Readable ID"
  - [ ] Add proper ARIA labels and accessibility attributes
  - [ ] Ensure visual indication of selected option
  - [ ] Follow existing design system patterns (consistent with status filter)

- [ ] Task 3: Integrate Selector with EmployeeList Component (AC: 2)
  - [ ] Modify EmployeeList component layout to include selector
  - [ ] Connect selector to employee store state management
  - [ ] Ensure responsive design works with new selector
  - [ ] Maintain existing search functionality while adding field selection

- [ ] Task 4: Update Search Functionality (AC: 1)
  - [ ] Modify search handling to use selected field type
  - [ ] Ensure search field and search value are coordinated
  - [ ] Maintain existing debouncing behavior (300ms delay)
  - [ ] Test search functionality across all field options

- [ ] Task 5: Testing Implementation (AC: 1, 2, 3, 4, 5, 6)
  - [ ] Create unit tests for search field selector component
  - [ ] Create integration tests with employee store
  - [ ] Test accessibility features (keyboard navigation, screen reader)
  - [ ] Test responsive design across different screen sizes
  - [ ] Validate component follows existing design patterns

## Dev Notes

### Component Specifications

**Search Field Options:**

- Human Readable ID (maps to `human_readable_user_id` database column)
- First Name (maps to `first_name` database column)
- Last Name (maps to `last_name` database column)
- Email (maps to `email` database column)
- Phone Number (maps to `phone` database column)

**Current Implementation Context:**

- Search currently uses multi-column ILIKE queries across `first_name`, `last_name`, `email`, `human_readable_user_id`
- Filter state managed in `EmployeeFilters` interface: `apps/web/app/lib/stores/employeeStore.ts:82-88`
- Current search input located at: `apps/web/components/employee-list.tsx:172-180`
- Existing status filter uses shadcn Select component: `apps/web/components/employee-list.tsx:181-194`

**UI Components Available:**

- shadcn Select component: `apps/web/components/ui/select.tsx`
- shadcn Input component (already used for search)
- Lucide icons available (Search, Filter, etc.)

### File Locations

**New Components to Create:**

- `apps/web/components/search-field-selector.tsx` - New search field selector component

**Files to Modify:**

- `apps/web/app/lib/stores/employeeStore.ts` - Add search field to filters interface
- `apps/web/components/employee-list.tsx` - Integrate selector component

### State Management

**Store Updates Needed:**

```typescript
interface EmployeeFilters {
  search?: string;
  searchField?: SearchFieldType; // NEW
  status?: EmploymentStatus | 'all';
  primaryRegion?: string;
  sortBy?: string;
  sortOrder?: 'asc' | 'desc';
}

type SearchFieldType =
  | 'human_readable_user_id'
  | 'first_name'
  | 'last_name'
  | 'email'
  | 'phone';
```

### Design System Patterns

- Follow existing status filter implementation pattern
- Use consistent spacing and responsive design (`flex-col sm:flex-row gap-4`)
- Maintain existing component structure and styling patterns
- Use same Select component styling and size as status filter

### Technical Constraints

- Must maintain existing search functionality while adding field selection
- Component must be accessible (WCAG AA compliance)
- Must work with existing responsive design patterns
- Cannot break existing filtering or pagination functionality

### Previous Story Insights

No previous stories exist for this epic. This is the first implementation story.

### Testing Requirements

**Test File Locations:**

- Component tests: `apps/web/components/__tests__/`
- Store tests: `apps/web/app/lib/stores/__tests__/`

**Testing Framework:**

- Use existing testing patterns and frameworks
- Test accessibility features with appropriate tools
- Validate responsive design across viewports
- Test integration with existing employee store functionality

**Specific Test Cases:**

- Test selector displays all five search field options
- Test default selection is "Human Readable ID"
- Test keyboard navigation through options
- Test ARIA labels and screen reader compatibility
- Test integration with search input functionality
- Test responsive layout on mobile and desktop

## Testing

### Testing Standards

**Test File Location:** Follow existing pattern - `apps/web/components/__tests__/SearchFieldSelector.test.tsx`

**Testing Frameworks:** Use existing testing setup (likely Jest + React Testing Library based on existing tests)

**Testing Requirements:**

- Unit tests for component rendering and interactions
- Integration tests with employee store
- Accessibility tests for keyboard navigation and ARIA compliance
- Responsive design tests for different screen sizes
- Test coverage minimum: 90% for new code

**Testing Patterns:**

- Follow existing component test patterns found in `apps/web/components/__tests__/EmployeeList.test.tsx`
- Use same mocking strategies for stores and dependencies
- Test user interactions and state changes
- Validate accessibility compliance

## Change Log

| Date       | Version | Description            | Author             |
| ---------- | ------- | ---------------------- | ------------------ |
| 2025-01-28 | 1.0     | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

_This section will be populated by the development agent during implementation_

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes List

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_Results from QA Agent review will be populated here_
